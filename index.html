
<html>

<head>
  <title>A-Frame Cubemap Component - Change Cubemap Test</title>
  <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
  <script src="cubemap.js"></script>
  <script>
    AFRAME.registerComponent('create-ktx2-loader', {
      schema: { type: 'string' },
      init: function () {
        // ktx2Loader = AFRAME.scenes[0].systems['gltf-model'].getKTX2Loader()
        // ktx2Loader.setWorkerLimit(8);
        // gl = scene.renderer.getContext();

        // //get compressed texture extensions
        // const ASTC_EXT = gl.getExtension("WEBGL_compressed_texture_astc")
        // const ETC_EXT = gl.getExtension("WEBGL_compressed_texture_etc")

        // if (ASTC_EXT) console.log("ASTC_EXT", ASTC_EXT)

        // if (ETC_EXT) console.log("ETC_EXT", ETC_EXT)
        // load()
      }
    });
  </script>
</head>

<body>
  <a-scene stats renderer="
  colorManagement: true;
antialias: true;
highRefreshRate: true;
anisotropy: 1;
foveationLevel: 0;">
    <a-entity id="skybox" scale="1 1 1"></a-entity>
  </a-scene>
  <script src="./encoder/build/basis_loader.js"></script>

  <script type="importmap">
      {
          "imports": {
              "three": "./three.js-master/three.js-master/build/three.module.js",
              "three/addons/": "./three.js-master/three.js-master/examples/jsm/"
          }
      }
  </script>
  <script type="module" src="./index.js"></script>

  
  <script type="text/javascript">
      let sckybox = document.getElementById('skybox')
      window.sckybox = sckybox
    // let compressedCubeTextureURLs = [

    //   'Assets/Textures/Cubemaps/desert-cube/jpgs/cubemap_uastc.ktx2', // right
    //   // 'Assets/Textures/Cubemaps/desert-cube/jpgs/cubemap.ktx2', // right
    //   // 'Assets/Textures/Cubemaps/louvre-cube/jpgs/cubemap.ktx2', // right
    //   // 'Assets/Textures/Cubemaps/snow-cube/jpgs/cubemap.ktx2', // right
    //   // 'Assets/Textures/Cubemaps/first-cube/jpgs/cubemap.ktx2', // right
    //   // 'Assets/Textures/Cubemaps/sky-cube/jpgs/cubemap.ktx2', // right

    // ]
    async function loadCompressed() {
      // const maxTextureSize = scene.renderer.capabilities.maxTextureSize;
      // console.log('Maximum texture size:', maxTextureSize);
      Promise.all(compressedCubeTextureURLs.map(url => ktx2Loader.loadAsync(url)))
        .then(textures => {
          console.log('Textures loaded:', textures);

          textures.forEach((texture, index) => {
            if (!texture) {
              console.error(`Texture at index ${index} failed to load.`);
            } else {
              console.log(`Texture at index ${index} loaded successfully:`, texture);
              // cubemapTextures.push(texture)
            }
          });
          console.log(textures.length)
          cubeTexture = textures[0]
        window.cubeTexture = textures[0]
        console.log('Cube texture loaded successfully:', window.cubeTexture);
        console.log('Cube texture type:', window.cubeTexture.constructor.name);
          console.log('Cube texture loaded successfully!');
          sckybox.setAttribute("cubemap", "");


        })
        .catch(error => {
          console.error('An error occurred loading the KTX2 textures:', error);
        });
    }
    
    // const loader = new THREE.CubeTextureLoader()
  
    // // Load the cube texture using promise
    // function loadNormal(){
    //   loader.loadAsync([
    //   'http://127.0.0.1:8080/projects/2024/pickaplace/Assets/Textures/Cubemaps/louvre-cube/jpgs/posx.jpg',
    //   'http://127.0.0.1:8080/projects/2024/pickaplace/Assets/Textures/Cubemaps/louvre-cube/jpgs/negx.jpg',
    //   'http://127.0.0.1:8080/projects/2024/pickaplace/Assets/Textures/Cubemaps/louvre-cube/jpgs/posy.jpg',
    //   'http://127.0.0.1:8080/projects/2024/pickaplace/Assets/Textures/Cubemaps/louvre-cube/jpgs/negy.jpg',
    //   'http://127.0.0.1:8080/projects/2024/pickaplace/Assets/Textures/Cubemaps/louvre-cube/jpgs/posz.jpg',
    //   'http://127.0.0.1:8080/projects/2024/pickaplace/Assets/Textures/Cubemaps/louvre-cube/jpgs/negz.jpg'
    // ]).then((cubeTexture) => {

    //   window.cubeTexture = cubeTexture
    //   // Code to execute on completion
    //   console.log('Cube texture loaded successfully!');
    //   sckybox.setAttribute("cubemap", "");
    //   // Additional code here...
    // }).catch((error) => {
    //   console.error('Error loading cube texture:', error);
    // });

    // }



  </script>

</body>

</html>
    






